PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H

ORG 1000H
MSJ DB "DERE SE LA COMEEEE"
FIN DB ?

ORG 2000H
;CONFIGURO EL PIO
MOV AL, 0FDH ;FD=11111101
OUT CA, AL; HAGO TODOS LOS BITS DE ENTRADA MENOS EL DE STROBE
MOV AL,0
OUT CB, AL; HAGO TODOS LOS BITS DE SALIDA PARA PODER MANDARLE EL DATO
IN AL, PA ;VEO EL ESTADO DE PA PARA MODIFICIAR EL BIT DE STROBE
AND AL, 0FDH; FUERZO A 0 EL BIT DE STROBE
OUT PA, AL


; PREPARO EL MENSAJE
MOV BX, OFFSET MSJ
POLL: IN AL, PA
AND AL, 1
JNZ POLL ;FUERZO EL BIT DE BUSY PARA VER SI LA IMPRESORA ESTA OCUPADA
MOV AL, [BX]
OUT PB, AL; ENVIO EL DATO A LA IMPRESORA
IN AL, PA; COMPRUEBO EL ESTADO DE PA-COMIENZA EL PULSO
OR AL, 2; FUERZO EL BIT DE STROBE A 1 
OUT PA, AL
IN AL, PA ;COMPRUEBO EL ESTADO DE PA
AND AL, 0FDH; FUERZO EL BIT DE STROBE A 0 PARA GENERAR EL PULSO NECESARIO
OUT PA, AL; TERMINA EL PULSO- TERMINA EL PULSO
INC BX
CMP BX, OFFSET FIN
JNZ POLL
END