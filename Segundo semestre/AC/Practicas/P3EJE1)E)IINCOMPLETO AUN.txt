PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H
EOI EQU 20H
IMR EQU 21H
IRR EQU 22H
ISR EQU 23h
INT1 EQU 25h
TIMER EQU 10H
COMP EQU 11H
N_CL EQU 10
N_CL2 EQU 11

ORG 40
IP_CL DW RUT_CLOCK

ORG 44
IP_CL2 DW RUT_CLOCK2

ORG 1000H
CONT DW ?

ORG 1500H
RUT_CLOCK: MOV AL, 0
OUT TIMER, AL
MOV AL, CONT
OUT PB, AL
MOV AL, EOI
OUT EOI, AL
ADD DL, DL
JC CONFIG
MOV CONT, DL
IRET 




ORG 3500H
RUT_CLOCK2: MOV AL, 0
OUT TIMER, AL
OUT PB, AL
MOV AL, EOI
OUT EOI, AL
IRET

ORG 2000H
CLI
MOV AL, N_CL
OUT INT1, AL
MOV AL, 0FDH
OUT IMR, AL
MOV AL, 0
OUT TIMER, AL
MOV AL,1
OUT COMP, AL
MOV CONT,0
MOV AL, 0
OUT PB, AL
MOV AL, 0
OUT CB, AL
MOV AL, 1
ADD DL, 1
ADD CONT, DL
SIGO: STI
MOV AL, 0
OUT TIMER, AL
JMP SIGO
CONFIG: CLI
MOV AL, N_CL2
OUT INT1, AL
STI


POLL: MOV AL, 0
OUT TIMER, AL
JMP POLL
FIN: INT 0
END